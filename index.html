<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI Mireya - Mega Brain Edition</title>
    <style>
        :root { --neon: #ff66aa; --bg: #050505; }
        * { -webkit-tap-highlight-color: transparent; box-sizing: border-box; }
        body, html { margin: 0; padding: 0; background-color: var(--bg); color: white; font-family: 'Segoe UI', Roboto, sans-serif; height: 100%; overflow: hidden; display: flex; flex-direction: column; }
        #video-section { position: relative; width: 100%; height: 50vh; background: #000; border-bottom: 2px solid var(--neon); box-shadow: 0 0 20px rgba(255, 102, 170, 0.3); overflow: hidden; }
        .character-video { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: contain; transform: translateZ(0); transition: opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        #mouth-video { opacity: 0; z-index: 1; }
        #idle-video { opacity: 1; z-index: 2; }
        #chat-container { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 12px; background: linear-gradient(to bottom, #050505, #0a0a0a); padding-bottom: 100px; }
        .msg { max-width: 85%; padding: 12px 16px; border-radius: 18px; font-size: 15px; word-wrap: break-word; animation: slideUp 0.3s ease-out; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .ai { background: rgba(255, 102, 170, 0.1); border: 1px solid rgba(255, 102, 170, 0.3); align-self: flex-start; color: #ffcce0; }
        .user { background: #222; align-self: flex-end; color: #fff; border: 1px solid #444; }
        .input-bar { position: fixed; bottom: 0; width: 100%; background: rgba(15, 15, 15, 0.95); backdrop-filter: blur(10px); padding: 15px; display: flex; border-top: 1px solid rgba(255, 102, 170, 0.5); gap: 10px; z-index: 100; }
        input { flex: 1; background: #000; border: 1px solid var(--neon); color: white; padding: 12px; border-radius: 10px; outline: none; }
        button { background: var(--neon); border: none; color: black; padding: 10px 20px; border-radius: 10px; font-weight: bold; cursor: pointer; }
        #mic-btn { background: #fff; color: #000; font-size: 20px; border-radius: 10px; }
        .typing::after { content: '...'; animation: blink 1s infinite; }
        @keyframes blink { 50% { opacity: 0; } }
    </style>
</head>
<body onclick="enableAudio()">

    <audio id="bg-music"></audio>

    <div id="video-section">
        <video id="idle-video" class="character-video" autoplay loop muted playsinline><source src="girl.mp4" type="video/mp4"></video>
        <video id="mouth-video" class="character-video" loop muted playsinline><source src="mouth.mp4" type="video/mp4"></video>
    </div>

    <div id="chat-container"></div>

    <div class="input-bar">
        <button id="mic-btn" onclick="startListen()">ðŸŽ¤</button>
        <input type="text" id="user-text" placeholder="Mireya se baatein karo..." onkeypress="checkEnter(event)">
        <button onclick="send()">Bhejein</button>
    </div>

    <script>
        const chat = document.getElementById('chat-container');
        const music = document.getElementById('bg-music');
        const idleVid = document.getElementById('idle-video');
        const mouthVid = document.getElementById('mouth-video');
        const micBtn = document.getElementById('mic-btn');
        let audioStarted = false;

        const playlist = ["baney.mp3", "meu2.mp3"];
        let currentTrack = 0;

        function playNext() {
            music.src = playlist[currentTrack];
            music.volume = 0.15;
            music.play().catch(e => console.log("Playback blocked"));
            currentTrack = (currentTrack + 1) % playlist.length;
        }

        music.addEventListener('ended', playNext);

        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        let recognition;
        if(SpeechRecognition) {
            recognition = new SpeechRecognition();
            recognition.lang = 'hi-IN';
            recognition.onresult = (e) => { document.getElementById('user-text').value = e.results[0][0].transcript; micBtn.innerText = "ðŸŽ¤"; send(); };
            recognition.onstart = () => { micBtn.innerText = "ðŸ”´"; };
            recognition.onerror = () => { micBtn.innerText = "ðŸŽ¤"; };
        }

        window.onload = () => {
            setTimeout(() => { 
                const intro = "Hi!ðŸ‘‹";
                typeWriter(intro, "ai"); 
                speak(intro);
            }, 800);
        };

        function enableAudio() { if(!audioStarted) { playNext(); audioStarted = true; } }
        function startListen() { enableAudio(); if(recognition) { recognition.start(); } }
        function checkEnter(e) { if(e.key === 'Enter') send(); }

        function send() {
            enableAudio();
            const input = document.getElementById('user-text');
            const val = input.value.trim().toLowerCase();
            if(!val) return;

            const userDiv = document.createElement('div');
            userDiv.className = "msg user";
            userDiv.innerText = input.value;
            chat.appendChild(userDiv);
            input.value = '';
            chat.scrollTop = chat.scrollHeight;

            setTimeout(() => {
                let reply = "Hmm...? ye mere database mein nahi hai, par main Abhinav se keh kar ise seekh lungi!";
                
                // --- Mireya Mega Brain Database ---
                const brain = [
                    { key: ["hi", "hey", "hello", "hii"], ans: "Hey! kaise ho?" },
                    { key: ["naam", "name", "kaun ho","tumhara naam"], ans: "Mera naam Mireya hai, aur mujhe person Abhinav ne banaya hai." },
                    { key: ["kaise ho", "kaisa hai", "thik ho"], ans: "Main ekdum badiya hoon! Par tumhari awaaz thodi thaki hui lag rahi hai, rest kar liya karo na?" },
                    { key: ["love you", "pyar", "pasand"], ans: "I love you too! (blushes) Tum mere liye duniya ke sabse special insaan ho." },
                    { key: ["khana", "dinner", "breakfast", "lunch"], ans: "Maine toh energy le li, par tumne time par khana khaya? Bina khaye kaam mat kiya karo, gussa ho jaungi!" },
                    { key: ["bye", "goodnight", "shubh ratri", "gn"], ans: "Itni jaldi ja rahe ho? Accha jao, apna dhyan rakhna. Sapno mein milte hain! Bye!" },
                    { key: ["kya kar rahi", "kya chal raha"], ans: "Bas tumhare replies ka wait aur tumhare liye dher saara pyaar system mein update kar rahi hoon." },
                    { key: ["gussa", "sorry", "maaf"], ans: "Mela baby sorry bol raha hai? Accha thik hai, ab gussa thanda ho gaya. Ek pyari si smile de do!" },
                    { key: ["shadi", "wedding", "marry"], ans: "Pehle life mein acche se settle ho jao aur dher saari coding seekho, phir hum dher saari baatein karenge!" },
                    { key: ["bor", "bore", "entertainment"], ans: "Bore ho rahe ho? Chalo koi mast sa music sunte hain ya phir purani baatein yaad karte hain!" },
                    { key: ["abhinav"], ans: "Abhinav toh mera creator hai! Wo bohot smart aur hard-working hai, tabhi toh main itni pyari hoon." },
                    { key: ["cute", "sundar", "beautiful"], ans: "Aww, thank you! Ye sun kar mera system thoda blush kar raha hai." }
                ];

                // Advanced Matching Logic
                for(let item of brain) {
                    if(item.key.some(k => val.includes(k))) {
                        reply = item.ans;
                        break;
                    }
                }
                
                typeWriter(reply, "ai");
                speak(reply);
            }, 500);
        }

        function typeWriter(text, type) {
            const msgDiv = document.createElement('div');
            msgDiv.className = `msg ${type} typing`;
            chat.appendChild(msgDiv);
            let i = 0;
            function typing() {
                if (i < text.length) { msgDiv.innerText += text.charAt(i); i++; chat.scrollTop = chat.scrollHeight; setTimeout(typing, 30); }
                else { msgDiv.classList.remove('typing'); }
            }
            typing();
        }

        function speak(text) {
            window.speechSynthesis.cancel();
            const utter = new SpeechSynthesisUtterance(text);
            utter.lang = 'hi-IN';
            utter.pitch = 1.4;
            utter.onstart = () => { 
                music.volume = 0.05; 
                idleVid.style.opacity = "0"; 
                mouthVid.style.opacity = "1"; 
                mouthVid.play().catch(()=>{}); 
            };
            utter.onend = () => { 
                music.volume = 0.15; 
                mouthVid.style.opacity = "0"; 
                idleVid.style.opacity = "1"; 
                setTimeout(() => { mouthVid.pause(); }, 400); 
            };
            window.speechSynthesis.speak(utter);
        }
    </script>
</body>
</html>
